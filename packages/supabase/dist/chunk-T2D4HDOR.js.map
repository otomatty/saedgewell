{"version":3,"sources":["../src/check-requires-mfa.ts"],"names":[],"mappings":";;;AAEA,IAAM,iBAAoB,GAAA,MAAA;AAQ1B,eAAsB,uCACpB,MACA,EAAA;AAIA,EAAA,MAAA,CAAO,KAAK,yBAA4B,GAAA,IAAA;AAExC,EAAA,MAAM,cAAiB,GAAA,MAAM,MAAO,CAAA,IAAA,CAAK,IAAI,8BAA+B,EAAA;AAG5E,EAAA,MAAA,CAAO,KAAK,yBAA4B,GAAA,KAAA;AAExC,EAAA,IAAI,eAAe,KAAO,EAAA;AACxB,IAAA,MAAM,IAAI,KAAA,CAAM,cAAe,CAAA,KAAA,CAAM,OAAO,CAAA;AAAA;AAG9C,EAAA,MAAM,EAAE,SAAA,EAAW,YAAa,EAAA,GAAI,cAAe,CAAA,IAAA;AAEnD,EAAO,OAAA,SAAA,KAAc,qBAAqB,SAAc,KAAA,YAAA;AAC1D","file":"chunk-T2D4HDOR.js","sourcesContent":["import type { SupabaseClient } from '@supabase/supabase-js';\n\nconst ASSURANCE_LEVEL_2 = 'aal2';\n\n/**\n * @name checkRequiresMultiFactorAuthentication\n * @description Checks if the current session requires multi-factor authentication.\n * We do it by checking that the next assurance level is AAL2 and that the current assurance level is not AAL2.\n * @param client\n */\nexport async function checkRequiresMultiFactorAuthentication(\n  client: SupabaseClient,\n) {\n  // Suppress the getSession warning. Remove when the issue is fixed.\n  // https://github.com/supabase/auth-js/issues/873\n  // @ts-expect-error: suppressGetSessionWarning is not part of the public API\n  client.auth.suppressGetSessionWarning = true;\n\n  const assuranceLevel = await client.auth.mfa.getAuthenticatorAssuranceLevel();\n\n  // @ts-expect-error: suppressGetSessionWarning is not part of the public API\n  client.auth.suppressGetSessionWarning = false;\n\n  if (assuranceLevel.error) {\n    throw new Error(assuranceLevel.error.message);\n  }\n\n  const { nextLevel, currentLevel } = assuranceLevel.data;\n\n  return nextLevel === ASSURANCE_LEVEL_2 && nextLevel !== currentLevel;\n}\n"]}